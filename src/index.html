<!DOCTYPE html>
<html>

<head>
	<link rel="icon" type="image/x-icon" href="/images/favicon.ico">
	<meta charset="UTF-8">
	<title>Zerocoinn Airdrop</title>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/antd/4.16.13/antd.min.css" crossorigin="anonymous"
		referrerpolicy="no-referrer" />
	<style>
		.errorMessage {
			position: fixed;
			top: 0;
			left: 0;
			right: 0;
			background-color: #f5222d;
			color: #fff;
			padding: 16px;
			display: flex;
			align-items: center;
			justify-content: space-between;
			text-align: center;
			width: 100%;
		}

		.errorMessageText {
    	margin: 0 auto;
  	}

		.errorMessage button {
			background-color: transparent;
			border: none;
			color: #fff;
			font-size: 16px;
			cursor: pointer;
		}
	</style>
</head>

<body>
	<div style="width: 400px; margin: 0 auto;">
		<h1>Zerocoinn Airdrop</h1>
		<form id="myForm" onSubmit="handleSubmit(event)">
			<div style="margin-bottom: 16px;">
				<label for="destination_address">Wallet Address</label>
				<input type="text" id="destination_address" name="destination_address" class="ant-input" />
			</div>
			<div style="margin-bottom: 16px;">
				<label for="amount">Amount</label>
				<input type="text" id="amount" name="amount" class="ant-input" />
			</div>
			<div style="display: flex; justify-content: space-between;">
				<button type="button" class="ant-btn ant-btn-danger" onClick="handleReset()">Reset</button>
				<button type="submit" class="ant-btn ant-btn-primary">Submit</button>
			</div>
			<div id="errorMessage" class="errorMessage" style="display: none;">
				<span id="errorMessageText"></span>
				<button type="button" onClick="handleCloseError()">X</button>
			</div>
			<div id="successMessage" style="color: green; margin-top: 16px;"></div>
		</form>
	</div>
	<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
	<script>
		const handleSubmit = async (event) => {
			event.preventDefault();
			const form = document.getElementById('myForm');
			const formData = new FormData(form);
			const destinationAddress = formData.get('destination_address');
			const amount = formData.get('amount');
			try {
				const response = await axios.get('/api/airdrop/ZEROCOINN', {
					params: {
						amount,
						destination_address: destinationAddress,
					},
				});
				const successMessage = document.getElementById('successMessage');
				successMessage.innerHTML = `\n<a href="${response.data.txUrl}">Signature: ${response.data.signature}</a>`;
				const errorMessage = document.getElementById('errorMessage');
				errorMessage.style.display = 'none';
			} catch (error) {
				const errorMessage = document.getElementById('errorMessage');
				const errorMessageText = document.getElementById('errorMessageText');
				errorMessageText.textContent = error.response.data.message;
				errorMessage.style.display = 'flex';
			}
			// console.log(response.data);
		};

		const handleReset = () => {
			const form = document.getElementById('myForm');
			form.reset();
			const errorMessage = document.getElementById('errorMessage');
			errorMessage.style.display = 'none';
			const successMessage = document.getElementById('successMessage');
			successMessage.textContent = '';
		};

		const handleCloseError = () => {
			const errorMessage = document.getElementById('errorMessage');
			errorMessage.style.display = 'none';
		};
	</script>
</body>

</html>